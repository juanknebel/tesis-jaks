%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Beamer Presentation
% LaTeX Template
% Version 1.0 (10/11/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND THEMES
%----------------------------------------------------------------------------------------

\documentclass{beamer}

\usepackage[utf8]{inputenc}

\mode<presentation> {

% The Beamer class comes with a number of default slide themes
% which change the colors and layouts of slides. Below this is a list
% of all the themes, uncomment each in turn to see what they look like.

%\usetheme{default}
%\usetheme{AnnArbor}
%\usetheme{Antibes}
%\usetheme{Bergen}
%\usetheme{Berkeley}
%\usetheme{Berlin}
%\usetheme{Boadilla}
%\usetheme{CambridgeUS}
%\usetheme{Copenhagen}
%\usetheme{Darmstadt}
%\usetheme{Dresden}
%\usetheme{Frankfurt}
%\usetheme{Goettingen}
%\usetheme{Hannover}
%\usetheme{Ilmenau}
%\usetheme{JuanLesPins}
%\usetheme{Luebeck}
\usetheme{Madrid}
%\usetheme{Malmoe}
%\usetheme{Marburg}
%\usetheme{Montpellier}
%\usetheme{PaloAlto}
%\usetheme{Pittsburgh}
%\usetheme{Rochester}
%\usetheme{Singapore}
%\usetheme{Szeged}
%\usetheme{Warsaw}

% As well as themes, the Beamer class has a number of color themes
% for any slide theme. Uncomment each of these in turn to see how it
% changes the colors of your current slide theme.

%\usecolortheme{albatross}
%\usecolortheme{beaver}
%\usecolortheme{beetle}
%\usecolortheme{crane}
%\usecolortheme{dolphin}
%\usecolortheme{dove}
%\usecolortheme{fly}
%\usecolortheme{lily}
%\usecolortheme{orchid}
%\usecolortheme{rose}
%\usecolortheme{seagull}
%\usecolortheme{seahorse}
%\usecolortheme{whale}
%\usecolortheme{wolverine}

%\setbeamertemplate{footline} % To remove the footer line in all slides uncomment this line
%\setbeamertemplate{footline}[page number] % To replace the footer line in all slides with a simple slide count uncomment this line

%\setbeamertemplate{navigation symbols}{} % To remove the navigation symbols from the bottom of all slides uncomment this line
}
\usepackage{amsmath}
\usepackage{multicol}
\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\let\Tiny=\tiny
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title[Ítems empaquetados]{Algoritmos para recuperación de ``ítems empaquetados''} % The short title appears at the bottom of every slide, the full title is only on the title page

\author{Juan Andrés Knebel \& Amit Stein} % Your name
\institute[UBA] % Your institution as it will appear on the bottom of every slide, may be shorthand to save space
{
Universidad de Buenos Aires\\Facultad de Ciencias Exactas y Naturales\\Departamento de Computación \\ % Your institution for the title page
\begin{center}
\includegraphics[width=2cm,height=2cm,keepaspectratio]{imagenes/logofcen.pdf}                                                                             \end{center}
}
\pgfdeclareimage[height=.1\textheight]{fcen}{imagenes/logofcen.pdf}
\pgfdeclareimage[height=.1\textheight]{dc}{imagenes/logo.jpg}
\logo{\pgfuseimage{dc}}

\date{} % Date, can be changed to a custom date

\setbeamertemplate{items}[default]
\setbeamertemplate{enumerate items}[default]
\begin{document}
\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

\begin{frame}
\frametitle{Contenido} % Table of contents slide, comment this block out to remove it
\tableofcontents % Throughout your presentation, if you choose to use \section{} and \subsection{} commands, these will automatically be printed on this slide as an overview of your presentation
\end{frame}

\section{Comprando discos on-line}
\frame{\frametitle{Comprando discos on-line} 
Un coleccionista de discos desea incorporar a su catalogo musical artistas provenientes de \underline{diferentes países}. Lo primordial en su búsqueda es que la elección final de discos pertenezca al mismo período de tiempo, sin importar la época a la que pertenecen. Las consideraciones a tener en cuenta deben ser:
\begin{itemize}
  \item Mismo período.
  \item Diferentes países de orígenes.
  \item Correspondan a varios países.
  \item No supere el presupuesto total de $\$ 100$.
\end{itemize}
}

\frame{\frametitle{Comprando discos on-line}
Para que el coleccionista encuentre su conjunto de discos podría realizar las siguientes consultas:
%\pause
}
%\frame[shrink=20]{\frametitle{Comprando discos on-line} 
%lalallala
%}

\section{IR vs CR} 
\frame{\frametitle{Recuperación Compuesta vs Recuperación de la Información}
\begin{itemize}
	\item Recuperación de la información es el arte de encontrar material, generalmente documentos, de naturaleza no estructurada, generalmente textos, que satisfagan una necesidad de información dentro de grandes colecciones, generalmente almacenadas en computadoras. (An Introduction to Information Retrieval, Manning, Raghavan, Schutze).
	\item Recuperación compuesta de la información es el estudio de métodos para crear, recuperar y clasificar respuestas compuestas i.e., ítems conectados bajo algún criterio.
	\item Motivación: ayudar a los usuarios a explorar un gran número de ítems relevantes de forma más eficiente.
\end{itemize}
}

\section{Definición formal} 
\frame{\frametitle{Definición del problema}
Dados:
\begin{itemize}
	\item Un conjunto de ítems, cada uno con
	\begin{itemize}
		\item atributos.
		\item un costo.
	\end{itemize}
	\item Una función de similitud entre todo par de ítems.
	\item Un presupuesto.
\end{itemize}
\pause
\bigskip
\textbf{Objetivo:}\\
Generar un conjunto \textit{diverso} de $k$ paquetes de ítems \textit{similares}.
}

\frame{\frametitle{Definición del problema}
Los paquetes deben cumplir las siguientes propiedades:
\begin{itemize}
	\item \textbf{Compatibilidad: } Los elementos dentro de un paquete deben ser similares. El grado de similitud de los elementos que forman un paquete define su calidad.
	\textit{Poner algo del ejemplo de los discos}.
	\pause
	\item \textbf{Validez: } El costo total de los elementos del paquete no puede superar el presupuesto.
	\textit{Poner algo del ejemplo de los discos}.
	\pause
	\item \textbf{Diversidad: } Los paquetes entre sí deben ser diversos.
	\textit{Poner algo del ejemplo de los discos}.
	\pause
	\item \textbf{Complementariedad: } Todos los paquetes cumplen que, para un mismo atributo especificado los elementos dentro de paquete contienen un valor diferente para tal propiedad.
	\textit{Poner algo del ejemplo de los discos}.
\end{itemize}
}

\frame{\frametitle{Definición del problema}
Dados:
\begin{itemize}
	\item un conjunto de ítems $I$.
	\item una función de similitud $s(u,v)$ para cada par $u,v \in I$.
	\item una función de complementariedad $\alpha$.
	\item una función de costos $f: 2^{I} \rightarrow \Re^{+}$.
	\item un presupuesto $\beta$.
	\item un entero $k$ (cantidad de paquetes).
\end{itemize}
\pause
Se debe hallar un conjunto de paquetes válidos $S = \{ S_{1}...S_{k} \}$ que maximice la función:
\small
$$
w(s) = \gamma \boxed{\sum_{1 \leq i \leq k}{\sum_{u,v \in S_i}{s(u,v)}}} 
+ (1-\gamma) \boxed{\sum_{1 \leq i < j \leq k} {(1-\max_{u \in S_i, v \in S_j}{s(u,v)})}}
$$
\normalsize
Cada paquete $S_{i} \in S$ es válido si y solo sí satisface las reglas:
\begin{itemize}
	\item \textbf{Complementariedad: } $\forall u,v \in S_{i} \alpha(u) \neq \alpha(v)$.
	\item \textbf{Presupuesto: } $\forall S_{i} \in S, f(S_{i}) \leq \beta$.
\end{itemize}

}

\section{Trabajos anteriores}
\frame{\frametitle{En el trabajo anterior}
\begin{itemize}
	\item Demostraron que el problema es NP-Difícil con una reducción desde Maximum edge subgraph.
	\item Desarrollaron dos familias de heurísticas:
	\begin{itemize}
		\item PAC (produce and choose):
		\begin{itemize}
			\item Se producen paquetes candidatos.
			\item Se seleccionan $k$ de estos paquetes.
		\end{itemize}
		\item CAP (cluster and pick):
		\begin{itemize}
			\item Se realiza un \textit{k-clustering} de los ítems por similitud (para generar paquetes con alta similitud).
			\item Dentro de cada \textit{cluster} se seleccionan ítems que formen un paquete válido (complementariedad y presupuesto).
		\end{itemize}
	\end{itemize}
	\item Presentaron un modelo de programación lineal entera.
	\item De la experimentación concluyeron que las mejores soluciones se obtienen con los algoritmos PAC.
\end{itemize}
}

\frame{\frametitle{En el trabajo anterior... Heurísticas PAC}
\begin{itemize}
	\item Producción de paquetes candidatos:
	\begin{itemize}
		\item C-HAC:
		\begin{itemize}
			\item \textit{Clustering} jerárquico aglomerativo con restricciones.
			\item Función \textit{Score: } similitudes de todos los ítems en el nuevo cluster.
		\end{itemize}
		\item BOBO-c (bundles one-by-one): Se generan $c*k$ paquetes seleccionando un ítem como pivote y golosamente construyendo un paquetes a su alrededor.
	\end{itemize}
	\pause
	\item Selección de paquetes candidatos (selección simple, SS):
	\begin{itemize}
		\item SE define un grafo pesado: sus nodos representan los paquetes candidatos (con peso dado por su valor intra) y el peso de una arista dado por el valor inter.
		\item Se busca el subgrafo de $k$ nodos de mayor peso.
		\item Heurística golosa: iterativamente se selecciona el paquete que maximiza la función objetivo evaluada en los paquetes hasta el momento seleccionados.
	\end{itemize}
\end{itemize}
}

\frame{\frametitle{En el trabajo anterior... Debilidades}
Por la naturaleza de PAC, las soluciones generadas se enfocan más en valorar la parte intra-paquete que la inter-paquetes.
\begin{itemize}
	\item C-HAC: Función \textit{Score} sólo presta atención a la similitud intra-paquete. Cuando se busca alta diversidad los paquetes generados no resulta buenos.
	\item SS:
	\begin{itemize}
		\item La componente intra de la función objetivo crece linealmente al agregarse un nuevo paquete a la solución. En contraste, la inter lo hace en forma cuadrática.
		\item Esto hace que en las soluciones parciales, la parte inter no tenga peso proporcional a su valor en la solución completa.
		\item En las primeras iteraciones el valor inter-paquetes es despreciable con respecto a la suma de los valores intra-paquete.
		\item Cuando se quiere privilegiar la diversidad de paquetes en la solución ésta no es una buena estrategia.
	\end{itemize}
\end{itemize}
}

\section{Nuevas propuestas}
\frame{\frametitle{Nuevas propuestas - Intra-inter C-HAC}
Dados dos clusters $C_{i}$ y $C_{j}$ definimos:

$$Intra-Inter(C_{i}, C_{j}) = \gamma A(C_{i},C_{j}) + t(1 - \gamma) E(C_{i},C_{j})$$
$$A(C_{i},C_{j}) = \sum_{u \in C_{i}, v \in C_{j}} s(u,v)$$
$$E(C_{i},C_{j}) = \max_{u \in C_{i}, v \in C_{j}} s(u,v)$$

\begin{itemize}
	\item Incrementará el valor intra.
	\item Se habrán unido dos \textit{clusters} con alta similitud favoreciendo la dispersión en el \textit{clustering} final.
	\item El factor $t$ equilibra los dos términos de esta sumatoria (el segundo resultará siempre despreciable con respecto al primero).
\end{itemize}
}

\frame{\frametitle{Nuevas propuestas - Intra-inter C-HAC}
Costo computacional del cálculo de la función Intra-Inter:
\begin{itemize}
	\item Estructuras con los valores $A$ y $E$.
	\item Actualización en tiempo constante a partir de las siguientes relaciones entre la iteración $r$ y la $r - 1$:
	$$A^{r}(C_{i} \cup C_{j},C_{s}) = A^{r-1}(C_{i},C_{s}) + A^{r-1}(C_{j},C_{s})$$
	$$E^{r}(C_{i} \cup C_{j},C_{s}) = \max(E^{r-1}(C_{i},C_{s}),E^{r-1}(C_{j},C_{s}))$$
	\item El valor de la función Intra-Inter para cada \textit{cluster} es almacenado en orden decreciente en una cola de prioridad.
	\item Permite el borrado e inserción en $\mathcal{O}(\log n)$, resultando la complejidad total del algoritmo $\mathcal{O}(n^{2}\log n)$
\end{itemize}
}

\frame{\frametitle{Nuevas propuestas - Selección proporcional}
Para neutralizar el comportamiento \textit{desproporcional} en la selección simple se ponderó en la iteración j-ésima del procedimiento:
\begin{itemize}
	\item la parte intra por $\dfrac{k}{j+1}$.
	\bigskip
	\item la parte inter por $\dfrac{k(k-1)}{j(j+1)}$.
\end{itemize}
}

\frame{\frametitle{Nuevas propuestas - Procedimientos de mejora}
Se realizaron dos implementaciones de procedimientos de mejora basados en la metaheurística de búsqueda tabú en las diferentes etapas:
\begin{itemize}
	\item Mejora \textbf{Inter-paquete}: se aplica a la fase de selección en los algoritmos PAC.
	\bigskip
	\item Mejora \textbf{Intra-paquete}: explora soluciones vecinas procurando obtener paquetes más cohesivos.
\end{itemize}
}

\frame{\frametitle{Nuevas propuestas - Mejora \textit{Inter-paquete}}
\begin{itemize}
	\item Intercambia paquetes seleccionados con paquetes generados en la etapa de producción pero que no han sido elegidos.
	\item Lista tabú de paquetes prohibidos, LT: paquetes que fueron eliminados de la solución en iteraciones anteriores.
	\item Se va actualizando esta lista con un criterio de permanencia en cantidad de iteraciones de los paquetes prohibidos.
	\item Criterio de aspiración: permite considerar un paquete tabú si este aumenta el valor de la mejor solución obtenida hasta el momento.
	\item Criterio de parada: cantidad máxima de iteraciones.
\end{itemize}
}

\frame{\frametitle{Nuevas propuestas - Mejora \textit{Inter-paquete}}
\tiny
$S$ conjunto de paquetes elegidos. $B$ conjunto de paquetes generados.
\begin{enumerate}
	\tiny
	\item $S^{*} = S, \overline{S} = S, LT = \emptyset$
	\item Mientras no se cumple criterio de parada hacer:
	\pause
	\begin{multicols}{2}
		\begin{enumerate}
			\tiny
			\item $b_{r}$ en $\overline{S}$ con menor inter:
			$$b_{r} = \argmin_{b_{j} \in \overline{S}} \sum_{\substack{b_{j} \in \overline{S}\\ b_{j} \neq b_{i}}} (1 - \max_{\substack{u \in b_{i}\\ v \in b_{j}}}s(u,v))$$
			\pause
			\item $b_{c}$ con menor inter en $\overline{S} \setminus \{b_{r}\}$
			\pause
			\item Candidatos $C$ ($\max$ inter a $b_{c}$:
			$$C = k-\argmax_{b_{j} \in B \setminus \overline{S}}(1 - \max_{\substack{u \in b_{i}\\ v \in b_{c}}}s(u,v))$$
			\pause
			\item Mejor paquete de $C$ no prohibido en \textit{LT} según el criterio:
			$$b = \argmax_{b_{s} \in C \setminus LT} \sum_{\substack{b_{i}, b_{j} \in \\ \overline{S} \setminus \{b_{r}\} \cup \{b_{s}\}}}(1 - \max_{\substack{u \in b_{i}\\ v \in b_{j}}}s(u,v))$$
			\pause
			\item Se evalúa el criterio de aspiración para los paquetes en $C \cap LT$:
			$$b_{tabu} = \argmax_{b_{s} \in C \cap LT}w(\overline{S} \setminus \{b_{r}\} \cup \{b_{s}\})$$
			\pause
			\item Si $\max(w(S^{*}), w(\overline{S} \setminus \{b_{r}\} \cup \{b\})) < w(\overline{S} \setminus \{b_{r}\} \cup \{b_{tabu}\})$ entonces
			$$\overline{S} = \overline{S} \setminus \{b_{r}\} \cup \{b_{tabu}\}$$
			Sino
			$$\overline{S} = \overline{S} \setminus \{b_{r}\} \cup \{b\}$$
			\pause
			\item Actualizar $LT$
			\pause
			\item Si $w(\overline{S}) > w(S^{*})$ entonces $S^{*} = \overline{S}$
			\pause
		\end{enumerate}
	\end{multicols}
	\item Retornar $S^{*}$
\end{enumerate}
}


\frame{\frametitle{Nuevas propuestas - Mejora \textit{Intra-paquete}}
\normalsize
Procurar obtener paquetes más cohesivos:
\begin{itemize}
	\item Elige el paquete $b$ de las solución actual con menor valor intra.
	\item Determina su ítem centroide $c$ como:
	$$c = \argmax_{v \in b} \sum_{w \in b}s(v,w)$$
	\item Determina el ítem de $b$ más alejado a él:
	$$i = \argmin_{v \in b}s(c,v)$$
	\item Arma lista de candidatos $C$: ítems más cercanos al centroide $c$ que no pertenecen a paquetes de la solución actual.
	\item Selecciona el ítem $r$ de $C$ que no es tabú con mayor valor intra del paquete $b \setminus \{i\} \cup \{r\}$.
	\item Arma la nueva solución reemplazando $b$ por $b \setminus \{i\} \cup \{r\}$.
	\item Criterio de aspiración similar a la búsqueda anterior.
\end{itemize}
}

\frame{\frametitle{Experimentación computacional}
}
\end{document}
